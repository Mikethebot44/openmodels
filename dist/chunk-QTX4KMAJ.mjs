var h=(a=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(a,{get:(s,t)=>(typeof require<"u"?require:s)[t]}):a)(function(a){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+a+'" is not supported')});import u from"node-fetch";var d=class{constructor(s){this.config=s}};var r=class extends Error{constructor(t,o,e){super(t);this.status=o;this.code=e;this.name="OpenModelsError"}};async function*m(a){if(!a.body)throw new r("Response body is null");if(a.status===401)throw new r("Invalid API key. Please check your credentials.",401);if(a.status===403)throw new r("Insufficient credits. Please top up your account.",403);let t=(await a.text()).split(`
`);for(let o of t){let e=o.trim();if(e!==""){if(e==="[DONE]")return;if(e.startsWith("data: ")){let i=e.slice(6);if(i==="[DONE]")return;try{let l=JSON.parse(i);l.choices?.[0]?.delta?.content&&(yield l.choices[0].delta.content)}catch{continue}}}}}var n=class extends d{async chat(s){let t=`${this.config.baseUrl}/chat`,o={"Content-Type":"application/json",Authorization:`Bearer ${this.config.apiKey}`},e=await u(t,{method:"POST",headers:o,body:JSON.stringify(s)});if(!e.ok){let i=await e.text();throw e.status===401?new r("Invalid API key. Please check your credentials.",401):e.status===403?new r("Insufficient credits. Please top up your account.",403):new r(`Modal API error: ${e.status} ${i}`,e.status)}return e}async embed(s){let t=`${this.config.baseUrl}/embed`,o={"Content-Type":"application/json",Authorization:`Bearer ${this.config.apiKey}`},e=await u(t,{method:"POST",headers:o,body:JSON.stringify(s)});if(!e.ok){let i=await e.text();throw e.status===401?new r("Invalid API key. Please check your credentials.",401):e.status===403?new r("Insufficient credits. Please top up your account.",403):new r(`Modal API error: ${e.status} ${i}`,e.status)}return e}async image(s){let t=`${this.config.baseUrl}/image`,o={"Content-Type":"application/json",Authorization:`Bearer ${this.config.apiKey}`},e=await u(t,{method:"POST",headers:o,body:JSON.stringify(s)});if(!e.ok){let i=await e.text();throw e.status===401?new r("Invalid API key. Please check your credentials.",401):e.status===403?new r("Insufficient credits. Please top up your account.",403):new r(`Modal API error: ${e.status} ${i}`,e.status)}return e}async audioTranscribe(s){let t=`${this.config.baseUrl}/transcribe`,o={"Content-Type":"application/json",Authorization:`Bearer ${this.config.apiKey}`},e=await u(t,{method:"POST",headers:o,body:JSON.stringify(s)});if(!e.ok){let i=await e.text();throw e.status===401?new r("Invalid API key. Please check your credentials.",401):e.status===403?new r("Insufficient credits. Please top up your account.",403):new r(`Modal API error: ${e.status} ${i}`,e.status)}return e}async audioSummarize(s){let t=`${this.config.baseUrl}/summarize`,o={"Content-Type":"application/json",Authorization:`Bearer ${this.config.apiKey}`},e=await u(t,{method:"POST",headers:o,body:JSON.stringify(s)});if(!e.ok){let i=await e.text();throw e.status===401?new r("Invalid API key. Please check your credentials.",401):e.status===403?new r("Insufficient credits. Please top up your account.",403):new r(`Modal API error: ${e.status} ${i}`,e.status)}return e}async visionClassify(s){let t=`${this.config.baseUrl}/classify`,o={"Content-Type":"application/json",Authorization:`Bearer ${this.config.apiKey}`},e=await u(t,{method:"POST",headers:o,body:JSON.stringify(s)});if(!e.ok){let i=await e.text();throw e.status===401?new r("Invalid API key. Please check your credentials.",401):e.status===403?new r("Insufficient credits. Please top up your account.",403):new r(`Modal API error: ${e.status} ${i}`,e.status)}return e}};var f={"image-classification":["google/vit-base-patch16-224","facebook/convnext-base-224","openai/clip-vit-base-patch32"],"text-generation":["microsoft/DialoGPT-medium","meta-llama/Llama-3.1-8B-Instruct"],embedding:["sentence-transformers/all-MiniLM-L6-v2"],"audio-transcribe":["openai/whisper-base"],"audio-summarize":["facebook/bart-large-cnn"],"image-generation":["runwayml/stable-diffusion-v1-5"]};function c(a){let s=f[a];if(!s||s.length===0)throw new Error(`No default models configured for task: ${a}`);return s[0]}var p=class{constructor(s={}){if(!s.apiKey)throw new r("API key is required. Please provide an API key in the client configuration.");if(!s.apiKey.startsWith("om_")||s.apiKey.length<10)throw new r('Invalid API key format. API keys must start with "om_" and be at least 10 characters long.');let t=s.baseUrl||"https://tryscout.dev",o=e=>t.includes("modal.run")||t.includes("/api/")?t:t.includes(".")?`${t}/api/${e}`:`https://tryscout.dev/api/${e}`;this.textProvider=new n({apiKey:s.apiKey,baseUrl:o("text")}),this.embedProvider=new n({apiKey:s.apiKey,baseUrl:o("embed")}),this.imageProvider=new n({apiKey:s.apiKey,baseUrl:o("image")}),this.audioProvider=new n({apiKey:s.apiKey,baseUrl:o("audio")}),this.visionProvider=new n({apiKey:s.apiKey,baseUrl:o("vision")})}async chat(s){try{let t=await this.textProvider.chat(s);return s.stream?m(t):await t.json()}catch(t){throw t instanceof Error?new r(t.message):new r("Unknown error occurred")}}async embed(s){try{return await(await this.embedProvider.embed(s)).json()}catch(t){throw t instanceof Error?new r(t.message):new r("Unknown error occurred")}}async image(s){try{return await(await this.imageProvider.image(s)).json()}catch(t){throw t instanceof Error?new r(t.message):new r("Unknown error occurred")}}async run(s){try{switch(s.task){case"text-generation":{let t=s.model||c("text-generation"),o={...s,model:t},e=await this.textProvider.chat(o);return o.stream?m(e):await e.json()}case"image-generation":{let t=s.model||c("image-generation"),o={...s,model:t};return await(await this.imageProvider.image(o)).json()}case"embedding":{let t=s.model||c("embedding"),o={...s,model:t};return await(await this.embedProvider.embed(o)).json()}case"audio-transcribe":{let t=s.model||c("audio-transcribe"),o={...s,model:t};return await(await this.audioProvider.audioTranscribe(o)).json()}case"audio-summarize":{let t=s.model||c("audio-summarize"),o={...s,model:t};return await(await this.audioProvider.audioSummarize(o)).json()}case"image-classification":{let t=s.model||c("image-classification"),o={...s,model:t};return await(await this.visionProvider.visionClassify(o)).json()}default:throw new r("Unsupported task")}}catch(t){throw t instanceof Error?new r(t.message):new r("Unknown error occurred")}}};function y(a){return new p(a)}export{h as a,r as b,m as c,n as d,p as e,y as f};
//# sourceMappingURL=chunk-QTX4KMAJ.mjs.map