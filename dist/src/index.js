"use strict";var f=Object.create;var d=Object.defineProperty;var w=Object.getOwnPropertyDescriptor;var P=Object.getOwnPropertyNames;var g=Object.getPrototypeOf,b=Object.prototype.hasOwnProperty;var v=(s,r)=>{for(var e in r)d(s,e,{get:r[e],enumerable:!0})},h=(s,r,e,n)=>{if(r&&typeof r=="object"||typeof r=="function")for(let t of P(r))!b.call(s,t)&&t!==e&&d(s,t,{get:()=>r[t],enumerable:!(n=w(r,t))||n.enumerable});return s};var x=(s,r,e)=>(e=s!=null?f(g(s)):{},h(r||!s||!s.__esModule?d(e,"default",{value:s,enumerable:!0}):e,s)),I=s=>h(d({},"__esModule",{value:!0}),s);var R={};v(R,{ModalProvider:()=>i,OpenModels:()=>c,OpenModelsError:()=>o,client:()=>y,parseSSEStream:()=>p});module.exports=I(R);var u=x(require("node-fetch"));var m=class{constructor(r){this.config=r}};var o=class extends Error{constructor(e,n,t){super(e);this.status=n;this.code=t;this.name="OpenModelsError"}};async function*p(s){if(!s.body)throw new o("Response body is null");if(s.status===401)throw new o("Invalid API key. Please check your credentials.",401);if(s.status===403)throw new o("Insufficient credits. Please top up your account.",403);let e=(await s.text()).split(`
`);for(let n of e){let t=n.trim();if(t!==""){if(t==="[DONE]")return;if(t.startsWith("data: ")){let a=t.slice(6);if(a==="[DONE]")return;try{let l=JSON.parse(a);l.choices?.[0]?.delta?.content&&(yield l.choices[0].delta.content)}catch{continue}}}}}var i=class extends m{async chat(r){let e=`${this.config.baseUrl}/chat`,n={"Content-Type":"application/json",Authorization:`Bearer ${this.config.apiKey}`},t=await(0,u.default)(e,{method:"POST",headers:n,body:JSON.stringify(r)});if(!t.ok){let a=await t.text();throw t.status===401?new o("Invalid API key. Please check your credentials.",401):t.status===403?new o("Insufficient credits. Please top up your account.",403):new o(`Modal API error: ${t.status} ${a}`,t.status)}return t}async embed(r){let e=`${this.config.baseUrl}/embed`,n={"Content-Type":"application/json",Authorization:`Bearer ${this.config.apiKey}`},t=await(0,u.default)(e,{method:"POST",headers:n,body:JSON.stringify(r)});if(!t.ok){let a=await t.text();throw t.status===401?new o("Invalid API key. Please check your credentials.",401):t.status===403?new o("Insufficient credits. Please top up your account.",403):new o(`Modal API error: ${t.status} ${a}`,t.status)}return t}async image(r){let e=`${this.config.baseUrl}/image`,n={"Content-Type":"application/json",Authorization:`Bearer ${this.config.apiKey}`},t=await(0,u.default)(e,{method:"POST",headers:n,body:JSON.stringify(r)});if(!t.ok){let a=await t.text();throw t.status===401?new o("Invalid API key. Please check your credentials.",401):t.status===403?new o("Insufficient credits. Please top up your account.",403):new o(`Modal API error: ${t.status} ${a}`,t.status)}return t}};var c=class{constructor(r={}){if(!r.apiKey)throw new o("API key is required. Please provide an API key in the client configuration.");if(!r.apiKey.startsWith("om_")||r.apiKey.length<10)throw new o('Invalid API key format. API keys must start with "om_" and be at least 10 characters long.');let e=r.baseUrl||"https://tryscout.dev",n=t=>e.includes("modal.run")||e.includes("/api/")?e:e.includes(".")?`${e}/api/${t}`:`https://tryscout.dev/api/${t}`;this.textProvider=new i({apiKey:r.apiKey,baseUrl:n("text")}),this.embedProvider=new i({apiKey:r.apiKey,baseUrl:n("embed")}),this.imageProvider=new i({apiKey:r.apiKey,baseUrl:n("image")})}async chat(r){try{let e=await this.textProvider.chat(r);return r.stream?p(e):await e.json()}catch(e){throw e instanceof Error?new o(e.message):new o("Unknown error occurred")}}async embed(r){try{return await(await this.embedProvider.embed(r)).json()}catch(e){throw e instanceof Error?new o(e.message):new o("Unknown error occurred")}}async image(r){try{return await(await this.imageProvider.image(r)).json()}catch(e){throw e instanceof Error?new o(e.message):new o("Unknown error occurred")}}};function y(s){return new c(s)}0&&(module.exports={ModalProvider,OpenModels,OpenModelsError,client,parseSSEStream});
//# sourceMappingURL=index.js.map