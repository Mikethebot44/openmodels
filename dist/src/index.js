"use strict";var y=Object.create;var m=Object.defineProperty;var l=Object.getOwnPropertyDescriptor;var w=Object.getOwnPropertyNames;var b=Object.getPrototypeOf,x=Object.prototype.hasOwnProperty;var R=(o,r)=>{for(var e in r)m(o,e,{get:r[e],enumerable:!0})},u=(o,r,e,n)=>{if(r&&typeof r=="object"||typeof r=="function")for(let t of w(r))!x.call(o,t)&&t!==e&&m(o,t,{get:()=>r[t],enumerable:!(n=l(r,t))||n.enumerable});return o};var C=(o,r,e)=>(e=o!=null?y(b(o)):{},u(r||!o||!o.__esModule?m(e,"default",{value:o,enumerable:!0}):e,o)),P=o=>u(m({},"__esModule",{value:!0}),o);var E={};R(E,{ModalProvider:()=>i,OpenModels:()=>c,OpenModelsError:()=>s,client:()=>g,parseSSEStream:()=>f});module.exports=P(E);var d=C(require("node-fetch"));var p=class{constructor(r){this.config=r}};var i=class extends p{async chat(r){let e=`${this.config.baseUrl}/chat`,n={"Content-Type":"application/json"};this.config.apiKey&&(n.Authorization=`Bearer ${this.config.apiKey}`);let t=await(0,d.default)(e,{method:"POST",headers:n,body:JSON.stringify(r)});if(!t.ok){let a=await t.text();throw new Error(`Modal API error: ${t.status} ${a}`)}return t}async embed(r){let e=`${this.config.baseUrl}/embed`,n={"Content-Type":"application/json"};this.config.apiKey&&(n.Authorization=`Bearer ${this.config.apiKey}`);let t=await(0,d.default)(e,{method:"POST",headers:n,body:JSON.stringify(r)});if(!t.ok){let a=await t.text();throw new Error(`Modal API error: ${t.status} ${a}`)}return t}async image(r){let e=`${this.config.baseUrl}/image`,n={"Content-Type":"application/json"};this.config.apiKey&&(n.Authorization=`Bearer ${this.config.apiKey}`);let t=await(0,d.default)(e,{method:"POST",headers:n,body:JSON.stringify(r)});if(!t.ok){let a=await t.text();throw new Error(`Modal API error: ${t.status} ${a}`)}return t}};var s=class extends Error{constructor(e,n,t){super(e);this.status=n;this.code=t;this.name="OpenModelsError"}};async function*f(o){if(!o.body)throw new s("Response body is null");let e=(await o.text()).split(`
`);for(let n of e){let t=n.trim();if(t!==""){if(t==="[DONE]")return;if(t.startsWith("data: ")){let a=t.slice(6);if(a==="[DONE]")return;try{let h=JSON.parse(a);h.choices?.[0]?.delta?.content&&(yield h.choices[0].delta.content)}catch{continue}}}}}var c=class{constructor(r={}){this.provider=new i({apiKey:r.apiKey,baseUrl:r.baseUrl||"https://modal.run/api/v1"})}async chat(r){try{let e=await this.provider.chat(r);return r.stream?f(e):await e.json()}catch(e){throw e instanceof Error?new s(e.message):new s("Unknown error occurred")}}async embed(r){try{return await(await this.provider.embed(r)).json()}catch(e){throw e instanceof Error?new s(e.message):new s("Unknown error occurred")}}async image(r){try{return await(await this.provider.image(r)).json()}catch(e){throw e instanceof Error?new s(e.message):new s("Unknown error occurred")}}};function g(o){return new c(o)}0&&(module.exports={ModalProvider,OpenModels,OpenModelsError,client,parseSSEStream});
//# sourceMappingURL=index.js.map