"use strict";var w=Object.create;var m=Object.defineProperty;var b=Object.getOwnPropertyDescriptor;var P=Object.getOwnPropertyNames;var T=Object.getPrototypeOf,x=Object.prototype.hasOwnProperty;var R=(a,t)=>{for(var s in t)m(a,s,{get:t[s],enumerable:!0})},g=(a,t,s,o)=>{if(t&&typeof t=="object"||typeof t=="function")for(let e of P(t))!x.call(a,e)&&e!==s&&m(a,e,{get:()=>t[e],enumerable:!(o=b(t,e))||o.enumerable});return a};var S=(a,t,s)=>(s=a!=null?w(T(a)):{},g(t||!a||!a.__esModule?m(s,"default",{value:a,enumerable:!0}):s,a)),I=a=>g(m({},"__esModule",{value:!0}),a);var q={};R(q,{ModalProvider:()=>n,OpenModels:()=>l,OpenModelsError:()=>r,client:()=>y,getModelCapabilities:()=>h,parseSSEStream:()=>c});module.exports=I(q);var p=S(require("node-fetch"));var d=class{constructor(t){this.config=t}};var r=class extends Error{constructor(s,o,e){super(s);this.status=o;this.code=e;this.name="OpenModelsError"}};async function*c(a){if(!a.body)throw new r("Response body is null");if(a.status===401)throw new r("Invalid API key. Please check your credentials.",401);if(a.status===403)throw new r("Insufficient credits. Please top up your account.",403);let s=(await a.text()).split(`
`);for(let o of s){let e=o.trim();if(e!==""){if(e==="[DONE]")return;if(e.startsWith("data: ")){let i=e.slice(6);if(i==="[DONE]")return;try{let f=JSON.parse(i);f.choices?.[0]?.delta?.content&&(yield f.choices[0].delta.content)}catch{continue}}}}}var n=class extends d{async chat(t){let s=`${this.config.baseUrl}/chat`,o={"Content-Type":"application/json",Authorization:`Bearer ${this.config.apiKey}`},e=await(0,p.default)(s,{method:"POST",headers:o,body:JSON.stringify(t)});if(!e.ok){let i=await e.text();throw e.status===401?new r("Invalid API key. Please check your credentials.",401):e.status===403?new r("Insufficient credits. Please top up your account.",403):new r(`Modal API error: ${e.status} ${i}`,e.status)}return e}async embed(t){let s=`${this.config.baseUrl}/embed`,o={"Content-Type":"application/json",Authorization:`Bearer ${this.config.apiKey}`},e=await(0,p.default)(s,{method:"POST",headers:o,body:JSON.stringify(t)});if(!e.ok){let i=await e.text();throw e.status===401?new r("Invalid API key. Please check your credentials.",401):e.status===403?new r("Insufficient credits. Please top up your account.",403):new r(`Modal API error: ${e.status} ${i}`,e.status)}return e}async image(t){let s=`${this.config.baseUrl}/image`,o={"Content-Type":"application/json",Authorization:`Bearer ${this.config.apiKey}`},e=await(0,p.default)(s,{method:"POST",headers:o,body:JSON.stringify(t)});if(!e.ok){let i=await e.text();throw e.status===401?new r("Invalid API key. Please check your credentials.",401):e.status===403?new r("Insufficient credits. Please top up your account.",403):new r(`Modal API error: ${e.status} ${i}`,e.status)}return e}async audioTranscribe(t){let s=`${this.config.baseUrl}/transcribe`,o={"Content-Type":"application/json",Authorization:`Bearer ${this.config.apiKey}`},e=await(0,p.default)(s,{method:"POST",headers:o,body:JSON.stringify(t)});if(!e.ok){let i=await e.text();throw e.status===401?new r("Invalid API key. Please check your credentials.",401):e.status===403?new r("Insufficient credits. Please top up your account.",403):new r(`Modal API error: ${e.status} ${i}`,e.status)}return e}async audioSummarize(t){let s=`${this.config.baseUrl}/summarize`,o={"Content-Type":"application/json",Authorization:`Bearer ${this.config.apiKey}`},e=await(0,p.default)(s,{method:"POST",headers:o,body:JSON.stringify(t)});if(!e.ok){let i=await e.text();throw e.status===401?new r("Invalid API key. Please check your credentials.",401):e.status===403?new r("Insufficient credits. Please top up your account.",403):new r(`Modal API error: ${e.status} ${i}`,e.status)}return e}async visionClassify(t){let s=`${this.config.baseUrl}/classify`,o={"Content-Type":"application/json",Authorization:`Bearer ${this.config.apiKey}`},e=await(0,p.default)(s,{method:"POST",headers:o,body:JSON.stringify(t)});if(!e.ok){let i=await e.text();throw e.status===401?new r("Invalid API key. Please check your credentials.",401):e.status===403?new r("Insufficient credits. Please top up your account.",403):new r(`Modal API error: ${e.status} ${i}`,e.status)}return e}};var k={"image-classification":["google/vit-base-patch16-224","facebook/convnext-base-224","openai/clip-vit-base-patch32"],"text-generation":["microsoft/DialoGPT-medium","meta-llama/Llama-3.1-8B-Instruct","meta-llama/Meta-Llama-3-8B-Instruct"],embedding:["sentence-transformers/all-MiniLM-L6-v2"],"audio-transcribe":["openai/whisper-base"],"audio-summarize":["facebook/bart-large-cnn"],"image-generation":["runwayml/stable-diffusion-v1-5"]};function u(a){let t=k[a];if(!t||t.length===0)throw new Error(`No default models configured for task: ${a}`);return t[0]}var l=class{constructor(t={}){if(!t.apiKey)throw new r("API key is required. Please provide an API key in the client configuration.");if(!t.apiKey.startsWith("om_")||t.apiKey.length<10)throw new r('Invalid API key format. API keys must start with "om_" and be at least 10 characters long.');let s=t.baseUrl||"https://tryscout.dev",o=e=>s.includes("modal.run")||s.includes("/api/")?s:s.includes(".")?`${s}/api/${e}`:`https://tryscout.dev/api/${e}`;this.textProvider=new n({apiKey:t.apiKey,baseUrl:o("text")}),this.embedProvider=new n({apiKey:t.apiKey,baseUrl:o("embed")}),this.imageProvider=new n({apiKey:t.apiKey,baseUrl:o("image")}),this.audioProvider=new n({apiKey:t.apiKey,baseUrl:o("audio")}),this.visionProvider=new n({apiKey:t.apiKey,baseUrl:o("vision")})}async chat(t){try{let s=await this.textProvider.chat(t);return t.stream?c(s):await s.json()}catch(s){throw s instanceof Error?new r(s.message):new r("Unknown error occurred")}}async embed(t){try{return await(await this.embedProvider.embed(t)).json()}catch(s){throw s instanceof Error?new r(s.message):new r("Unknown error occurred")}}async image(t){try{return await(await this.imageProvider.image(t)).json()}catch(s){throw s instanceof Error?new r(s.message):new r("Unknown error occurred")}}async run(t){try{switch(t.task){case"text-generation":{let s=t.model||u("text-generation"),o={...t,model:s},e=await this.textProvider.chat(o);return o.stream?c(e):await e.json()}case"image-generation":{let s=t.model||u("image-generation"),o={...t,model:s};return await(await this.imageProvider.image(o)).json()}case"embedding":{let s=t.model||u("embedding"),o={...t,model:s};return await(await this.embedProvider.embed(o)).json()}case"audio-transcribe":{let s=t.model||u("audio-transcribe"),o={...t,model:s};return await(await this.audioProvider.audioTranscribe(o)).json()}case"audio-summarize":{let s=t.model||u("audio-summarize"),o={...t,model:s};return await(await this.audioProvider.audioSummarize(o)).json()}case"image-classification":{let s=t.model||u("image-classification"),o={...t,model:s};return await(await this.visionProvider.visionClassify(o)).json()}default:throw new r("Unsupported task")}}catch(s){throw s instanceof Error?new r(s.message):new r("Unknown error occurred")}}};function y(a){return new l(a)}var v={"microsoft/DialoGPT-medium":{supportsTopP:!0,supportsStop:!0,supportsTemperature:!0,supportsMaxTokens:!0,supportsStreaming:!0,supportsQuantization:!0,supportedQuantizations:["int8","float16"],maxTokenLimit:1e3,notes:"Conversational model, best for dialog"},"microsoft/DialoGPT-large":{supportsTopP:!0,supportsStop:!0,supportsTemperature:!0,supportsMaxTokens:!0,supportsStreaming:!0,supportsQuantization:!0,supportedQuantizations:["int8","float16"],maxTokenLimit:1e3},"meta-llama/Llama-3.1-8B-Instruct":{supportsTopP:!0,supportsStop:!0,supportsTemperature:!0,supportsMaxTokens:!0,supportsStreaming:!0,supportsQuantization:!0,supportedQuantizations:["int8","int4","float16"],maxTokenLimit:4096,notes:"Instruction-following model"},"meta-llama/Meta-Llama-3-8B-Instruct":{supportsTopP:!0,supportsStop:!0,supportsTemperature:!0,supportsMaxTokens:!0,supportsStreaming:!0,supportsQuantization:!0,supportedQuantizations:["int8","int4","float16"],maxTokenLimit:4096,notes:"Instruction-following model with chat formatting"},"facebook/blenderbot-400M-distill":{supportsTopP:!0,supportsStop:!1,supportsTemperature:!0,supportsMaxTokens:!0,supportsStreaming:!0,supportsQuantization:!0,supportedQuantizations:["int8","float16"],maxTokenLimit:128},"EleutherAI/gpt-neo-2.7B":{supportsTopP:!0,supportsStop:!0,supportsTemperature:!0,supportsMaxTokens:!0,supportsStreaming:!0,supportsQuantization:!0,supportedQuantizations:["int8","int4","float16"],maxTokenLimit:2048}},M={"runwayml/stable-diffusion-v1-5":{supportsTopP:!1,supportsStop:!1,supportsTemperature:!1,supportsMaxTokens:!1,supportsStreaming:!1,supportsQuantization:!0,supportedQuantizations:["float16"],notes:"Size, quality, style parameters supported"},"stabilityai/stable-diffusion-xl-base-1.0":{supportsTopP:!1,supportsStop:!1,supportsTemperature:!1,supportsMaxTokens:!1,supportsStreaming:!1,supportsQuantization:!0,supportedQuantizations:["float16"],notes:"Higher quality, slower generation"}},C={"sentence-transformers/all-MiniLM-L6-v2":{supportsTopP:!1,supportsStop:!1,supportsTemperature:!1,supportsMaxTokens:!1,supportsStreaming:!1,supportsQuantization:!1,notes:"Fast and efficient, good for most tasks"}},A={"google/vit-base-patch16-224":{supportsTopP:!1,supportsStop:!1,supportsTemperature:!1,supportsMaxTokens:!1,supportsStreaming:!1,supportsQuantization:!0,supportedQuantizations:["int8","float16"],notes:"Vision Transformer, good balance"},"facebook/convnext-base-224":{supportsTopP:!1,supportsStop:!1,supportsTemperature:!1,supportsMaxTokens:!1,supportsStreaming:!1,supportsQuantization:!0,supportedQuantizations:["int8","float16"]},"openai/clip-vit-base-patch32":{supportsTopP:!1,supportsStop:!1,supportsTemperature:!1,supportsMaxTokens:!1,supportsStreaming:!1,supportsQuantization:!0,supportedQuantizations:["int8","float16"]}},z={"openai/whisper-base":{supportsTopP:!1,supportsStop:!1,supportsTemperature:!1,supportsMaxTokens:!1,supportsStreaming:!1,supportsQuantization:!0,supportedQuantizations:["int8","float16"],notes:"Fast, good for most languages"},"openai/whisper-small":{supportsTopP:!1,supportsStop:!1,supportsTemperature:!1,supportsMaxTokens:!1,supportsStreaming:!1,supportsQuantization:!0,supportedQuantizations:["int8","float16"],notes:"Better accuracy than base"},"openai/whisper-medium":{supportsTopP:!1,supportsStop:!1,supportsTemperature:!1,supportsMaxTokens:!1,supportsStreaming:!1,supportsQuantization:!0,supportedQuantizations:["int8","float16"],notes:"High accuracy, slower"}};function h(a,t){let s={supportsTopP:!1,supportsStop:!1,supportsTemperature:!1,supportsMaxTokens:!1,supportsStreaming:!1,supportsQuantization:!1},o;switch(t){case"text":o=v;break;case"image":o=M;break;case"embed":o=C;break;case"vision":o=A;break;case"audio":o=z;break;default:return s}return o[a]||s}0&&(module.exports={ModalProvider,OpenModels,OpenModelsError,client,getModelCapabilities,parseSSEStream});
//# sourceMappingURL=index.js.map