"use strict";var g=Object.create;var p=Object.defineProperty;var b=Object.getOwnPropertyDescriptor;var v=Object.getOwnPropertyNames;var S=Object.getPrototypeOf,P=Object.prototype.hasOwnProperty;var O=(r,e)=>{for(var t in e)p(r,t,{get:e[t],enumerable:!0})},y=(r,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of v(e))!P.call(r,o)&&o!==t&&p(r,o,{get:()=>e[o],enumerable:!(n=b(e,o))||n.enumerable});return r};var R=(r,e,t)=>(t=r!=null?g(S(r)):{},y(e||!r||!r.__esModule?p(t,"default",{value:r,enumerable:!0}):t,r)),E=r=>y(p({},"__esModule",{value:!0}),r);var M={};O(M,{ModalProvider:()=>i,OpenModels:()=>a,OpenModelsError:()=>s,client:()=>w,parseSSEStream:()=>m});module.exports=E(M);var C=R(require("node-fetch"));var d=class{constructor(e){this.config=e}};var i=class extends d{async chat(e){let t=`${this.config.baseUrl}/chat`,n={"Content-Type":"application/json"};this.config.apiKey&&(n.Authorization=`Bearer ${this.config.apiKey}`);let o=await(0,C.default)(t,{method:"POST",headers:n,body:JSON.stringify(e)});if(!o.ok){let l=await o.text();throw new Error(`Modal API error: ${o.status} ${l}`)}return o}};var s=class extends Error{constructor(t,n,o){super(t);this.status=n;this.code=o;this.name="OpenModelsError"}};async function*m(r){if(!r.body)throw new s("Response body is null");let e=r.body.getReader(),t=new TextDecoder,n="";try{for(;;){let{done:o,value:l}=await e.read();if(o)break;n+=t.decode(l,{stream:!0});let u=n.split(`
`);n=u.pop()||"";for(let x of u){let c=x.trim();if(c!==""){if(c==="[DONE]")return;if(c.startsWith("data: ")){let h=c.slice(6);if(h==="[DONE]")return;try{let f=JSON.parse(h);f.choices?.[0]?.delta?.content&&(yield f.choices[0].delta.content)}catch{continue}}}}}}finally{e.releaseLock()}}var a=class{constructor(e={}){this.provider=new i({apiKey:e.apiKey,baseUrl:e.baseUrl||"https://modal.run/api/v1"})}async chat(e){try{let t=await this.provider.chat(e);return e.stream?m(t):await t.json()}catch(t){throw t instanceof Error?new s(t.message):new s("Unknown error occurred")}}};function w(r){return new a(r)}0&&(module.exports={ModalProvider,OpenModels,OpenModelsError,client,parseSSEStream});
//# sourceMappingURL=index.js.map