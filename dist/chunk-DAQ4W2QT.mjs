var u=(n=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(n,{get:(r,e)=>(typeof require<"u"?require:r)[e]}):n)(function(n){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+n+'" is not supported')});import d from"node-fetch";var c=class{constructor(r){this.config=r}};var i=class extends c{async chat(r){let e=`${this.config.baseUrl}/chat`,o={"Content-Type":"application/json"};this.config.apiKey&&(o.Authorization=`Bearer ${this.config.apiKey}`);let t=await d(e,{method:"POST",headers:o,body:JSON.stringify(r)});if(!t.ok){let a=await t.text();throw new Error(`Modal API error: ${t.status} ${a}`)}return t}async embed(r){let e=`${this.config.baseUrl}/embed`,o={"Content-Type":"application/json"};this.config.apiKey&&(o.Authorization=`Bearer ${this.config.apiKey}`);let t=await d(e,{method:"POST",headers:o,body:JSON.stringify(r)});if(!t.ok){let a=await t.text();throw new Error(`Modal API error: ${t.status} ${a}`)}return t}async image(r){let e=`${this.config.baseUrl}/image`,o={"Content-Type":"application/json"};this.config.apiKey&&(o.Authorization=`Bearer ${this.config.apiKey}`);let t=await d(e,{method:"POST",headers:o,body:JSON.stringify(r)});if(!t.ok){let a=await t.text();throw new Error(`Modal API error: ${t.status} ${a}`)}return t}};var s=class extends Error{constructor(e,o,t){super(e);this.status=o;this.code=t;this.name="OpenModelsError"}};async function*f(n){if(!n.body)throw new s("Response body is null");let e=(await n.text()).split(`
`);for(let o of e){let t=o.trim();if(t!==""){if(t==="[DONE]")return;if(t.startsWith("data: ")){let a=t.slice(6);if(a==="[DONE]")return;try{let p=JSON.parse(a);p.choices?.[0]?.delta?.content&&(yield p.choices[0].delta.content)}catch{continue}}}}}var m=class{constructor(r={}){this.provider=new i({apiKey:r.apiKey,baseUrl:r.baseUrl||"https://modal.run/api/v1"})}async chat(r){try{let e=await this.provider.chat(r);return r.stream?f(e):await e.json()}catch(e){throw e instanceof Error?new s(e.message):new s("Unknown error occurred")}}async embed(r){try{return await(await this.provider.embed(r)).json()}catch(e){throw e instanceof Error?new s(e.message):new s("Unknown error occurred")}}async image(r){try{return await(await this.provider.image(r)).json()}catch(e){throw e instanceof Error?new s(e.message):new s("Unknown error occurred")}}};function h(n){return new m(n)}export{u as a,i as b,s as c,f as d,m as e,h as f};
//# sourceMappingURL=chunk-DAQ4W2QT.mjs.map